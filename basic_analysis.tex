\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Insect survey 2020, basic analysis},
            pdfauthor={Jens Å},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{Insect survey 2020, basic analysis}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
  \author{Jens Å}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \predate{\centering\large\emph}
  \postdate{\par}
  \date{29 October, 2020}


%\linespread{1.3}


% You know, for landscape
\usepackage{lscape}
\usepackage{pdfpages}


% pandoc does not parse latex env - https://groups.google.com/forum/?fromgroups=#!topic/pandoc-discuss/oZETB5Ii1Cw
\newcommand{\blandscape}{\begin{landscape}}
\newcommand{\elandscape}{\end{landscape}}

% Make new page before each section
%\let\stdsection\section
%\renewcommand\section{\newpage\stdsection}

% Highlight inline `code`
\usepackage{soul}
\usepackage{xcolor}

\definecolor{Light}{gray}{.97}
\sethlcolor{Light}

\let\OldTexttt\texttt
\renewcommand{\texttt}[1]{\OldTexttt{\hl{#1}}}


\clubpenalty=10000      %kara za sierotki
\widowpenalty=10000  % nie pozostawiaj wdów
\brokenpenalty=10000    % nie dziel wyrazów miêdzy stronami
\exhyphenpenalty=999999   % nie dziel s³ów z myœlnikiem
\righthyphenmin=3     % dziel minimum 3 litery

\renewcommand{\topfraction}{0.95}
\renewcommand{\bottomfraction}{0.95}
\renewcommand{\textfraction}{0.05}
\renewcommand{\floatpagefraction}{0.35}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\textbf{To-do}

\begin{itemize}
\item
  These species are not matched to the gyldig names in artsdatabasen
  yet.
\item
  Should store dates and times separately as well in logger\_data table.
  Easier to subset later.
\item
  Update weight figures with bottle weight removed.
\item
  Make plots of phenology

  \begin{itemize}
  \tightlist
  \item
    No.~species over the season for each location. Split into separate
    figs for the two habitats?
  \item
    Relate this to local temperature, temperature sums?
  \end{itemize}
\item
  Plots of number of samples over time
\item
  Check differences btw 2 week and 4 week sampling

  \begin{itemize}
  \tightlist
  \item
    Species occurrences,
  \item
    compare 2 * 2 weeks vs.~1 * 4 week
  \item
    Compare first and second of the 2 weeks, see if any of the have more
    overlap with 4 week. If 4 week becomes full, the first 2 week period
    should overlap more.
  \item
    Do this for window traps as well.
  \end{itemize}
\item
  Check overlap/additions of window traps vs.~malaise traps

  \begin{itemize}
  \tightlist
  \item
    Subset only Coleoptera
  \item
    Group by location + time
  \end{itemize}
\item
  Within habitat, check relationship btw species richness and a few
  variables

  \begin{itemize}
  \tightlist
  \item
    Forest age
  \item
    Diversity of fauna
  \item
    Temperature
  \item
    Altitude
  \end{itemize}
\item
  Check differences btw ethanol and propglyk window traps
\end{itemize}

\hypertarget{data-import-and-cleaning}{%
\section{Data import and cleaning}\label{data-import-and-cleaning}}

At this point I get the raw data from Marie, which requires some
cleaning. In the future, we'll put this all in a database, and separate
out the cleaning and database import in a separate script.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#dat <- read.delim("../../Data/Genetikkdata/long_format_data_GCF-2020-735_736_19102020.txt", sep= " ") %>% }
\CommentTok{#  as.tibble()}

\CommentTok{#dat <- read_delim("../../Data/Genetikkdata/long_format_data_GCF-2020-735_736_19102020.txt",}

\NormalTok{dat <-}\StringTok{ }\KeywordTok{read_delim}\NormalTok{(}\StringTok{"../../Data/Genetikkdata/long_format_data_GCF-2020-735_736_744_26102020.txt"}\NormalTok{, }
                  \DataTypeTok{delim=} \StringTok{";"}\NormalTok{,}
                  \DataTypeTok{col_types =} \KeywordTok{cols}\NormalTok{(}
  \DataTypeTok{kingdom =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{phylum =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{class =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{order =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{family =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{genus =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{species =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{sample =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{value =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{GenlabID =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{GUID =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{Tilsatt_antall_C.analis_SI_USA_08.06.20 =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Tilsatt_antall_C.chinensis_08.06.20 =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Tilsatt_antall_Sirisser =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Tilsatt_antall_Melormer =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Tilsatt_antall_C.maculatus =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Vekt_tom_flaske_.g. =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Vekt_flaske_med_EtOH_og_insekter_.g. =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Vekt_flaske_._insekter_vaat_.g. =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Vekt_flaske_._insekter_toerr_.g. =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Totalvolum_.mengde_ATL_._prot.K_mL. =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{Vaatvekt_.g. =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Toerrvekt_.g. =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Kommentar_proeve =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{Ekstraksjonsdato =} \KeywordTok{col_date}\NormalTok{(}\DataTypeTok{format =} \StringTok{"%d.%m.%Y"}\NormalTok{),}
  \DataTypeTok{Ekstraksjonskit =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{Subsamplet_volum_.ul. =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Elueringsvolum =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{OD =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{X260_280 =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{X260_230 =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{Labperson =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{Ekstraksjonskommentar =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{locality =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{trap =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{date_placed =} \KeywordTok{col_date}\NormalTok{(}\DataTypeTok{format =} \StringTok{"%d.%m.%Y"}\NormalTok{),}
  \DataTypeTok{time_placed =} \KeywordTok{col_time}\NormalTok{(}\DataTypeTok{format =} \StringTok{""}\NormalTok{),}
  \DataTypeTok{empty_week =} \KeywordTok{col_double}\NormalTok{(),}
  \DataTypeTok{date_emptied =} \KeywordTok{col_date}\NormalTok{(}\DataTypeTok{format =} \StringTok{"%d.%m.%Y"}\NormalTok{),}
  \DataTypeTok{time_emptied =} \KeywordTok{col_time}\NormalTok{(}\DataTypeTok{format =} \StringTok{""}\NormalTok{),}
  \DataTypeTok{liquid =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{person_emptied =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{sample_id =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{mottat_lab =} \KeywordTok{col_character}\NormalTok{(),}
  \DataTypeTok{comment =} \KeywordTok{col_character}\NormalTok{()}
\NormalTok{),}
\DataTypeTok{na =} \KeywordTok{c}\NormalTok{(}\StringTok{"NA"}\NormalTok{,}
       \StringTok{"N/A"}\NormalTok{,}
       \StringTok{"Maa veies"}
\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Fix some coding errors.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# dat %>% }
\CommentTok{#   select(genus, species, new_species) %>% }
\CommentTok{# slice(297, 1902)}
\CommentTok{#   }
\CommentTok{# }
\CommentTok{# dat %>% }
\CommentTok{#   select(genus, species, new_species) %>% }
\CommentTok{# slice(3219, 3585, 4017, 11424, 13275, 15465, 21056, 24168, 25077, 31567, 32805, 48502, 49967)}
\CommentTok{#   }
\CommentTok{#Ekstraksjonskommentar = gsub(pattern = "[\textbackslash{}\textbackslash{}\textbackslash{}"]", "", Ekstraksjonskommentar),}

\NormalTok{dat <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{species_latin =}\NormalTok{ species)}

\NormalTok{dat <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{species =} \KeywordTok{gsub}\NormalTok{(}\StringTok{" sp"}\NormalTok{, }\StringTok{"_sp"}\NormalTok{, species))}

\NormalTok{dat <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{species =} \KeywordTok{gsub}\NormalTok{(}\StringTok{"([0-9])(_)(sp)"}\NormalTok{, }\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{1/}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{3"}\NormalTok{, species))}

\NormalTok{dat <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{species =} \KeywordTok{gsub}\NormalTok{(}\StringTok{"(.*)(_)(.*)"}\NormalTok{, }\StringTok{"}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{3"}\NormalTok{, species))}
\end{Highlighting}
\end{Shaded}

Set factor levels

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{locality =} \KeywordTok{factor}\NormalTok{(locality, }\DataTypeTok{levels =} \KeywordTok{c}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"semi-nat_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{), }\KeywordTok{paste0}\NormalTok{(}\StringTok{"skog_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{), }\StringTok{"Nerlandsoeya"}\NormalTok{)),}
         \DataTypeTok{trap_type =} \KeywordTok{ifelse}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(}\StringTok{"MF"}\NormalTok{, trap), }\StringTok{"Malaise"}\NormalTok{, }\StringTok{"Vindu"}\NormalTok{),}
         \DataTypeTok{habitat_type =} \KeywordTok{ifelse}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(}\StringTok{"skog"}\NormalTok{, locality), }\StringTok{"Skog"}\NormalTok{, }\StringTok{"SN_Gressmark"}\NormalTok{),}
         \DataTypeTok{liquid =} \KeywordTok{ifelse}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(}\StringTok{"eto"}\NormalTok{, liquid), }\StringTok{"Ethanol"}\NormalTok{, }\StringTok{"PropGl_Ethanol"}\NormalTok{),}
         \DataTypeTok{weeks_sampled =} \KeywordTok{ifelse}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(}\StringTok{"1"}\NormalTok{, trap) }\OperatorTok{|}\StringTok{ }\KeywordTok{grepl}\NormalTok{(}\StringTok{"3"}\NormalTok{, trap), }\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{         )}
\end{Highlighting}
\end{Shaded}

\hypertarget{filter-out-the-nerlandsuxf8ya-samples}{%
\section{Filter out the Nerlandsøya
samples}\label{filter-out-the-nerlandsuxf8ya-samples}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(locality }\OperatorTok{!=}\StringTok{ "Nerlandsoeya"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{droplevels}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\hypertarget{check-the-emptying-dates.}{%
\subsection{Check the emptying dates.}\label{check-the-emptying-dates.}}

The dates seems to be OK this time. Should do a proper check on the
endpoints though.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{days_collected =} \KeywordTok{as.numeric}\NormalTok{(dat}\OperatorTok{$}\NormalTok{date_emptied }\OperatorTok{-}\StringTok{ }\NormalTok{dat}\OperatorTok{$}\NormalTok{date_placed))}

\CommentTok{# dat %>% }
\CommentTok{#   filter(days_collected == 0) %>% }
\CommentTok{#   select(sample_id,}
\CommentTok{#          GUID,}
\CommentTok{#          date_placed,}
\CommentTok{#          date_emptied) %>% }
\CommentTok{#   distinct() %>% }
\CommentTok{#   print(n = Inf)}
\CommentTok{# }
\CommentTok{# hist(as.numeric(dat$date_emptied - dat$date_placed))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(days_collected) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\KeywordTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` ungrouping output (override with `.groups` argument)
\end{verbatim}

\begin{verbatim}
## # A tibble: 16 x 2
##    days_collected `n()`
##             <dbl> <int>
##  1             10   368
##  2             11  1084
##  3             12  5654
##  4             13  6223
##  5             14 10831
##  6             15  8053
##  7             16 11159
##  8             17  1422
##  9             25   561
## 10             26  1101
## 11             27  3016
## 12             28  9687
## 13             29  1132
## 14             30   450
## 15             31  1175
## 16             32   734
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# dat %>% }
\CommentTok{#   filter(days_collected == 8) %>% }
\CommentTok{#   select(sample_id,}
\CommentTok{#          GUID,}
\CommentTok{#          date_placed,}
\CommentTok{#          date_emptied) %>% }
\CommentTok{#   distinct() %>% }
\CommentTok{#   print(n = Inf)}
\end{Highlighting}
\end{Shaded}

Set weeks sampled manually for the few locations in Oslo that got an
extra short sampling in the beginning.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(dat, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ weeks_sampled, }\DataTypeTok{y =}\NormalTok{ days_collected, }\DataTypeTok{group =}\NormalTok{ weeks_sampled)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/unnamed-chunk-8-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{twoWeeks <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(weeks_sampled }\OperatorTok{==}\StringTok{ }\DecValTok{4} \OperatorTok{&}
\StringTok{           }\NormalTok{days_collected }\OperatorTok{<}\StringTok{ }\DecValTok{20}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(sample_id) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{distinct}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{as.vector}\NormalTok{()}


\NormalTok{dat <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{weeks_sampled =} \KeywordTok{ifelse}\NormalTok{(sample_id }\OperatorTok{%in%}\StringTok{ }\NormalTok{twoWeeks[[}\DecValTok{1}\NormalTok{]], }\DecValTok{2}\NormalTok{, weeks_sampled))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(dat, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ weeks_sampled, }\DataTypeTok{y =}\NormalTok{ days_collected, }\DataTypeTok{group =}\NormalTok{ weeks_sampled)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/unnamed-chunk-10-1.png}

\hypertarget{check-missing-weight-data}{%
\section{Check missing weight data}\label{check-missing-weight-data}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(empty_week) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(Vekt_tom_flaske_.g.,}
\NormalTok{         Vekt_flaske_med_EtOH_og_insekter_.g.,}
\NormalTok{         Vekt_flaske_._insekter_vaat_.g.,}
\NormalTok{         Vekt_flaske_._insekter_toerr_.g.,}
\NormalTok{         Vaatvekt_.g.,}
\NormalTok{         Toerrvekt_.g.}
\NormalTok{         ) }\OperatorTok{%>%}\StringTok{  }
\StringTok{  }\KeywordTok{distinct}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarise_all}\NormalTok{(}\OperatorTok{~}\KeywordTok{sum}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(.)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Adding missing grouping variables: `empty_week`
\end{verbatim}

\begin{verbatim}
## # A tibble: 6 x 7
##   empty_week Vekt_tom_flaske~ Vekt_flaske_med~ Vekt_flaske_._i~ Vekt_flaske_._i~
##        <dbl>            <int>            <int>            <int>            <int>
## 1         22                6                0                0                0
## 2         24               20                0                0                0
## 3         26               19                3                0                2
## 4         28                4                9                0                0
## 5         30                2                2                0                2
## 6         32                0                0                0                0
## # ... with 2 more variables: Vaatvekt_.g. <int>, Toerrvekt_.g. <int>
\end{verbatim}

\hypertarget{basic-species-richness-graphs}{%
\section{Basic species richness
graphs}\label{basic-species-richness-graphs}}

Quick look at diversity at the different sites.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{total_no_taxa <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }\KeywordTok{select}\NormalTok{(genus,species) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{distinct}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{count}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(}\StringTok{"MF"}\NormalTok{, trap)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(locality) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(genus,species) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{distinct}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{count}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ungroup}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{ }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ n, }\DataTypeTok{x =}\NormalTok{ locality, }\DataTypeTok{fill =}\NormalTok{ locality),}
           \DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Kumulativ artsrikedom i}\CharTok{\textbackslash{}n}\StringTok{alle malaisefeller per "}\NormalTok{, }\KeywordTok{max}\NormalTok{(dat}\OperatorTok{$}\NormalTok{date_emptied))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{90}\NormalTok{, }\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{),}
        \DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{scale_fill_nina}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Antall taksa"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Lokalitet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Adding missing grouping variables: `locality`
\end{verbatim}

\includegraphics{figure/no_spec_loc_malaise-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(}\StringTok{"VF"}\NormalTok{, trap)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(locality) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(genus,species) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{distinct}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{count}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ungroup}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ n, }\DataTypeTok{x =}\NormalTok{ locality, }\DataTypeTok{fill =}\NormalTok{ locality),}
           \DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}
\StringTok{   }\KeywordTok{ggtitle}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Kumulativ artsrikedom i}\CharTok{\textbackslash{}n}\StringTok{alle vindusfeller per  "}\NormalTok{, }\KeywordTok{max}\NormalTok{(dat}\OperatorTok{$}\NormalTok{date_emptied))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{90}\NormalTok{, }\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{),}
        \DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{)  }\OperatorTok{+}
\StringTok{    }\KeywordTok{scale_fill_nina}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Antall taksa"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Lokalitet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Adding missing grouping variables: `locality`
\end{verbatim}

\includegraphics{figure/no_spec_loc_window-1.png}

\hypertarget{basic-biomass-graphs}{%
\section{Basic biomass graphs}\label{basic-biomass-graphs}}

NB, we still have some missing data on the weight of the bottles.

Quick quality check of the spread of the bottle weights. Could we impute
the missing values?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(Vekt_tom_flaske_.g.,}
\NormalTok{         Vekt_flaske_med_EtOH_og_insekter_.g.,}
\NormalTok{         Vekt_flaske_._insekter_vaat_.g.,}
\NormalTok{         Vekt_flaske_._insekter_toerr_.g.,}
\NormalTok{         Vaatvekt_.g.,}
\NormalTok{         Toerrvekt_.g.)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 62,650 x 6
##    Vekt_tom_flaske~ Vekt_flaske_med~ Vekt_flaske_._i~ Vekt_flaske_._i~
##               <dbl>            <dbl>            <dbl>            <dbl>
##  1             82.2              728             118.             89.0
##  2             82.2              728             118.             89.0
##  3             82.2              728             118.             89.0
##  4             82.2              728             118.             89.0
##  5             82.2              728             118.             89.0
##  6             82.2              728             118.             89.0
##  7             82.2              728             118.             89.0
##  8             82.2              728             118.             89.0
##  9             82.2              728             118.             89.0
## 10             82.2              728             118.             89.0
## # ... with 62,640 more rows, and 2 more variables: Vaatvekt_.g. <dbl>,
## #   Toerrvekt_.g. <dbl>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(dat)  }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_histogram}\NormalTok{(}\KeywordTok{aes}\NormalTok{(Vekt_tom_flaske_.g., }\DataTypeTok{fill =}\NormalTok{ trap_type))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\begin{verbatim}
## Warning: Removed 6572 rows containing non-finite values (stat_bin).
\end{verbatim}

\includegraphics{figure/unnamed-chunk-14-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(dat}\OperatorTok{$}\NormalTok{Vekt_tom_flaske_.g.)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/unnamed-chunk-15-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{table}\NormalTok{(dat}\OperatorTok{$}\NormalTok{Vekt_tom_flaske_.g.)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##   69.75   82.21 82.2103 
##    2915   40333   12830
\end{verbatim}

These bottle weights are weirdly consistent. Did they really weigh all
bottles? UPDATE WITH NEW BOTTLE WEIGHTS.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(dat}\OperatorTok{$}\NormalTok{Toerrvekt_.g.)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##  -0.570   4.740   8.328  13.463  16.170  80.350    9411
\end{verbatim}

Quick look at the biomass at the different sites.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(}\StringTok{"MF"}\NormalTok{, trap)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(locality) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{ }\KeywordTok{geom_boxplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ Vekt_flaske_._insekter_vaat_.g., }\DataTypeTok{x =}\NormalTok{ locality, }\DataTypeTok{fill =}\NormalTok{ locality)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Middels avrunnen vekt (pluss flaske)}\CharTok{\textbackslash{}n}\StringTok{av insekter i malaisefeller per "}\NormalTok{, }\KeywordTok{max}\NormalTok{(dat}\OperatorTok{$}\NormalTok{date_emptied))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{90}\NormalTok{, }\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{),}
        \DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{scale_fill_nina}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Vekt (g.)"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Lokalitet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/wet_weight_loc_malaise-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(}\StringTok{"VF"}\NormalTok{, trap)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(locality) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{ }\KeywordTok{geom_boxplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ Vekt_flaske_._insekter_vaat_.g., }\DataTypeTok{x =}\NormalTok{ locality, }\DataTypeTok{fill =}\NormalTok{ locality)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Middels avrunnen vekt (pluss flaske) av insekter i vindusfeller per "}\NormalTok{, }\KeywordTok{max}\NormalTok{(dat}\OperatorTok{$}\NormalTok{date_emptied))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{90}\NormalTok{, }\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{),}
        \DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{scale_fill_nina}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Vekt (g.)"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Lokalitet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/wet_weight_loc_window-1.png}

\hypertarget{check-overlap-between-malaise-and-window-traps}{%
\section{Check overlap between malaise and window
traps}\label{check-overlap-between-malaise-and-window-traps}}

Simple: total spec richn for all traps and times per location, plus the
same for just malaise and window traps. group in figure by location

complex: tally how many spec is found in only one trap type. No
unecessary

per species: which sp is only found in one trap type. or per species, \%
of findings in each trap type

\hypertarget{total-number-of-coleoptera-species-per-trap-type}{%
\subsection{Total number of coleoptera species per trap
type}\label{total-number-of-coleoptera-species-per-trap-type}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{col_spec_richn_tot <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(order }\OperatorTok{==}\StringTok{ "Coleoptera"}\NormalTok{,}
\NormalTok{         habitat_type }\OperatorTok{==}\StringTok{ "Skog"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(locality) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{col_spec_richn =} \KeywordTok{n_distinct}\NormalTok{(genus, species)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{trap_type =} \StringTok{"Alle"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` ungrouping output (override with `.groups` argument)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{col_spec_richn_trap <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(order }\OperatorTok{==}\StringTok{ "Coleoptera"}\NormalTok{,}
\NormalTok{         habitat_type }\OperatorTok{==}\StringTok{ "Skog"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(locality,}
\NormalTok{           trap_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{col_spec_richn =} \KeywordTok{n_distinct}\NormalTok{(genus, species))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` regrouping output by 'locality' (override with `.groups` argument)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{col_spec_richn <-}\StringTok{ }\NormalTok{col_spec_richn_tot }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{union_all}\NormalTok{(col_spec_richn_trap)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(col_spec_richn, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ col_spec_richn, }
                           \DataTypeTok{x =}\NormalTok{ locality, }
                           \DataTypeTok{fill =}\NormalTok{ trap_type)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{,}
           \DataTypeTok{position =} \KeywordTok{position_dodge}\NormalTok{()) }\OperatorTok{+}
\StringTok{    }\KeywordTok{ggtitle}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Kumulativt antall billearter (identifiserte taksa)}\CharTok{\textbackslash{}n}\StringTok{i hver felletyp per "}\NormalTok{, }\KeywordTok{max}\NormalTok{(dat}\OperatorTok{$}\NormalTok{date_emptied))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{90}\NormalTok{, }\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Felletype"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Antall taksa"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Lokalitet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/col_spec_richn_trap-1.png}

\hypertarget{percentage-of-catches-in-each-trap-type-per-species}{%
\subsection{Percentage of catches in each trap type per
species}\label{percentage-of-catches-in-each-trap-type-per-species}}

How to make it more readable? Split out all the singletons into a
separate graph?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{col_perc_traptype <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(order }\OperatorTok{==}\StringTok{ "Coleoptera"}\NormalTok{,}
\NormalTok{         habitat_type }\OperatorTok{==}\StringTok{ "Skog"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(trap_type,}
\NormalTok{           genus,}
\NormalTok{           species_latin) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{no_catches =} \KeywordTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` regrouping output by 'trap_type', 'genus' (override with `.groups` argument)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p1 <-}\StringTok{ }\NormalTok{col_perc_traptype }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ungroup}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{arrange}\NormalTok{(species_latin,}
\NormalTok{          trap_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(no_catches }\OperatorTok{>}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{slice}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{50}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(trap_type) }\OperatorTok{%>%}\StringTok{ }
\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =} \KeywordTok{reorder}\NormalTok{(species_latin, }\KeywordTok{desc}\NormalTok{(species_latin)), }\DataTypeTok{x =}\NormalTok{ no_catches, }\DataTypeTok{fill =}\NormalTok{ trap_type), }
           \DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{,}
           \DataTypeTok{position =} \KeywordTok{position_dodge}\NormalTok{()) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Trap type"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{""}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Number of catches"}\NormalTok{) }\OperatorTok{+}
\StringTok{   }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
         \DataTypeTok{text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{5}\NormalTok{))}


\NormalTok{p2 <-}\StringTok{ }\NormalTok{col_perc_traptype }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ungroup}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{arrange}\NormalTok{(species_latin,}
\NormalTok{          trap_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(no_catches }\OperatorTok{>}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{slice}\NormalTok{(}\DecValTok{51}\OperatorTok{:}\DecValTok{100}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(trap_type) }\OperatorTok{%>%}\StringTok{ }
\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =} \KeywordTok{reorder}\NormalTok{(species_latin, }\KeywordTok{desc}\NormalTok{(species_latin)), }\DataTypeTok{x =}\NormalTok{ no_catches, }\DataTypeTok{fill =}\NormalTok{ trap_type), }
           \DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{,}
           \DataTypeTok{position =} \KeywordTok{position_dodge}\NormalTok{()) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Trap type"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{""}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Number of catches"}\NormalTok{) }\OperatorTok{+}
\StringTok{   }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
         \DataTypeTok{text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{5}\NormalTok{))}

\NormalTok{p3 <-}\StringTok{ }\NormalTok{col_perc_traptype }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ungroup}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{arrange}\NormalTok{(species_latin,}
\NormalTok{          trap_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(no_catches }\OperatorTok{>}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{slice}\NormalTok{(}\DecValTok{101}\OperatorTok{:}\DecValTok{150}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(trap_type) }\OperatorTok{%>%}\StringTok{ }
\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =} \KeywordTok{reorder}\NormalTok{(species_latin, }\KeywordTok{desc}\NormalTok{(species_latin)), }\DataTypeTok{x =}\NormalTok{ no_catches, }\DataTypeTok{fill =}\NormalTok{ trap_type), }
           \DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{,}
           \DataTypeTok{position =} \KeywordTok{position_dodge}\NormalTok{()) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Trap type"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{""}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Number of catches"}\NormalTok{) }\OperatorTok{+}
\StringTok{   }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
         \DataTypeTok{text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{5}\NormalTok{))}


\NormalTok{p4 <-}\StringTok{ }\NormalTok{col_perc_traptype }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ungroup}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{arrange}\NormalTok{(species_latin,}
\NormalTok{          trap_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(no_catches }\OperatorTok{>}\StringTok{ }\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{slice}\NormalTok{(}\DecValTok{151}\OperatorTok{:}\DecValTok{200}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(trap_type) }\OperatorTok{%>%}\StringTok{ }
\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =} \KeywordTok{reorder}\NormalTok{(species_latin, }\KeywordTok{desc}\NormalTok{(species_latin)), }\DataTypeTok{x =}\NormalTok{ no_catches, }\DataTypeTok{fill =}\NormalTok{ trap_type), }
           \DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{,}
           \DataTypeTok{position =} \KeywordTok{position_dodge}\NormalTok{()) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Trap type"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{""}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Number of catches"}\NormalTok{) }\OperatorTok{+}
\StringTok{   }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{5}\NormalTok{))}

\KeywordTok{grid.arrange}\NormalTok{(p1, p2, p3, p4, }\DataTypeTok{nrow =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/col_perc_traptype-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{col_perc_traptype }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ungroup}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{arrange}\NormalTok{(species_latin,}
\NormalTok{          trap_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(no_catches }\OperatorTok{==}\DecValTok{1}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(trap_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{no_singletons =} \KeywordTok{n}\NormalTok{()) }\OperatorTok{%>%}\StringTok{ }
\StringTok{ }\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ no_singletons, }\DataTypeTok{x =}\NormalTok{ trap_type, }\DataTypeTok{fill =}\NormalTok{ trap_type), }
           \DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Trap type"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Number of singleton Coleoptera species"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{""}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` ungrouping output (override with `.groups` argument)
\end{verbatim}

\includegraphics{figure/no_col_singletons-1.png}

\hypertarget{figs-to-niclas-on-pollinators}{%
\section{Figs to Niclas on
Pollinators}\label{figs-to-niclas-on-pollinators}}

Niclas Gyllenstrand asked how efficient the malaisetraps+metabarcoding
are at finding pollinators. This could be a relevant graph for the
report as well.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{poll_spec_richn <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(trap_type }\OperatorTok{==}\StringTok{ "Malaise"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(family }\OperatorTok{==}\StringTok{ "Andrenidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Apidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Colletidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Halictidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Megachilidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Melittidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Syrphidae"} \OperatorTok{|}
\StringTok{          }
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Hesperiidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Lycaenidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Nymphalidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Papilionidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Pieridae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Riodinidae"}
\NormalTok{           ) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(family) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{distinct}\NormalTok{(family, genus, species) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{col_spec_richn =} \KeywordTok{n}\NormalTok{(),}
            \DataTypeTok{no_unidentified_sp =} \KeywordTok{sum}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(}\StringTok{"sp."}\NormalTok{, species)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` ungrouping output (override with `.groups` argument)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(poll_spec_richn, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ family, }\DataTypeTok{y =}\NormalTok{ col_spec_richn, }\DataTypeTok{label =}\NormalTok{ col_spec_richn)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{, }
           \KeywordTok{aes}\NormalTok{(}\DataTypeTok{fill =}\NormalTok{ family)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{3}\NormalTok{,}
            \DataTypeTok{position =} \KeywordTok{position_nudge}\NormalTok{(}\DataTypeTok{y =} \DecValTok{4}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{90}\NormalTok{, }\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Family"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{""}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Number of species"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/poll_spec_richn-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pollinator_species <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(trap_type }\OperatorTok{==}\StringTok{ "Malaise"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(family }\OperatorTok{==}\StringTok{ "Andrenidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Apidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Colletidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Halictidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Megachilidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Melittidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Syrphidae"} \OperatorTok{|}
\StringTok{          }
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Hesperiidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Lycaenidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Nymphalidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Papilionidae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Pieridae"} \OperatorTok{|}
\StringTok{         }\NormalTok{family }\OperatorTok{==}\StringTok{ "Riodinidae"}
\NormalTok{           ) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{distinct}\NormalTok{(order, family, genus, species) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{arrange}\NormalTok{(family, genus, species) }
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(trap_type }\OperatorTok{==}\StringTok{ "Malaise"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(family }\OperatorTok{==}\StringTok{ "Apidae"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{distinct}\NormalTok{(genus, species) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(genus, species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 17 x 2
##    genus    species    
##    <chr>    <chr>      
##  1 Apis     mellifera  
##  2 Bombus   soroeensis 
##  3 Bombus   pascuorum  
##  4 Bombus   lucorum    
##  5 Bombus   jonellus   
##  6 Bombus   pratorum   
##  7 Bombus   monticola  
##  8 Melipona illota     
##  9 Bombus   consobrinus
## 10 Bombus   cryptarum  
## 11 Bombus   sporadicus 
## 12 Bombus   cingulatus 
## 13 Bombus   hortorum   
## 14 Bombus   hypnorum   
## 15 Bombus   norvegicus 
## 16 Bombus   ashtoni    
## 17 Bombus   terrestris
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{write_csv}\NormalTok{(pollinator_species, }
          \DataTypeTok{path =} \StringTok{"out/pollinator_species.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{phenology-graphs}{%
\section{Phenology graphs}\label{phenology-graphs}}

Some ``timeseries'' throughout the season.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seasonAvgNo <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(weeks_sampled }\OperatorTok{==}\StringTok{ }\DecValTok{2}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(habitat_type, date_emptied, locality) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{no_species =} \KeywordTok{n_distinct}\NormalTok{(genus, species),}
            \DataTypeTok{sum_biomass =} \KeywordTok{sum}\NormalTok{(Vekt_flaske_._insekter_vaat_.g., }\DataTypeTok{na.rm =}\NormalTok{ T) }\OperatorTok{/}\StringTok{ }\NormalTok{no_species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` regrouping output by 'habitat_type', 'date_emptied' (override with `.groups` argument)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# test <- seasonAvgNo <- dat %>% }
\CommentTok{#   filter(weeks_sampled == 2) %>% }
\CommentTok{#   group_by(habitat_type, date_emptied, locality) %>% }
\CommentTok{#   select(habitat_type, date_emptied, locality, Vekt_flaske_._insekter_vaat_.g.) %>% }
\CommentTok{#   distinct() %>% }
\CommentTok{#   summarise(sum(Vekt_flaske_._insekter_vaat_.g., na.rm = T))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seasonAvgNo }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(habitat_type }\OperatorTok{==}\StringTok{ "Skog"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ date_emptied, }\DataTypeTok{y =}\NormalTok{ no_species, }\DataTypeTok{color =}\NormalTok{ locality)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ date_emptied, }\DataTypeTok{y =}\NormalTok{ no_species, }\DataTypeTok{color =}\NormalTok{ locality)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Antall taksa"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Tømmedato"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Lokalitet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/no_spec_phenology_forest-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seasonAvgNo }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(habitat_type }\OperatorTok{==}\StringTok{ "SN_Gressmark"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ date_emptied, }\DataTypeTok{y =}\NormalTok{ no_species, }\DataTypeTok{color =}\NormalTok{ locality)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ date_emptied, }\DataTypeTok{y =}\NormalTok{ no_species, }\DataTypeTok{color =}\NormalTok{ locality)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Antall taksa"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Tømmedato"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Lokalitet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/no_spec_phenology_grassland-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seasonAvgNo }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(habitat_type }\OperatorTok{==}\StringTok{ "Skog"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ date_emptied, }\DataTypeTok{y =}\NormalTok{ sum_biomass, }\DataTypeTok{color =}\NormalTok{ locality)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ date_emptied, }\DataTypeTok{y =}\NormalTok{ sum_biomass, }\DataTypeTok{color =}\NormalTok{ locality)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Total innsamlet biomasse (våtvekt g., pluss flaske)"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Tømmedato"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Lokalitet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/biomass_phenology_forest-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seasonAvgNo }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(habitat_type }\OperatorTok{==}\StringTok{ "SN_Gressmark"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\KeywordTok{ggplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ date_emptied, }\DataTypeTok{y =}\NormalTok{ sum_biomass, }\DataTypeTok{color =}\NormalTok{ locality)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ date_emptied, }\DataTypeTok{y =}\NormalTok{ sum_biomass, }\DataTypeTok{color =}\NormalTok{ locality)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Total innsamlet biomasse (våtvekt g. pluss flaske)"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Tømmedato"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Lokalitet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/biomass_phenology_grassland-1.png}

\hypertarget{plot-some-weather-data}{%
\section{Plot some weather data}\label{plot-some-weather-data}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logger_tbl <-}\StringTok{ }\KeywordTok{tbl}\NormalTok{(con,}
                   \KeywordTok{in_schema}\NormalTok{(}\StringTok{"loggers"}\NormalTok{, }\StringTok{"logger_data"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{id)}

\NormalTok{logger_dep_tbl <-}\StringTok{ }\KeywordTok{tbl}\NormalTok{(con,}
                   \KeywordTok{in_schema}\NormalTok{(}\StringTok{"loggers"}\NormalTok{, }\StringTok{"logger_deployments"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{id)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logger_data <-}\StringTok{ }\NormalTok{logger_tbl }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{left_join}\NormalTok{(logger_dep_tbl,}
            \DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"logger_id"}\NormalTok{ =}\StringTok{ "logger_id"}\NormalTok{,}
                   \StringTok{"logger_type"}\NormalTok{ =}\StringTok{ "logger_type"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{day =} \KeywordTok{as.Date}\NormalTok{(date))}
\end{Highlighting}
\end{Shaded}

Plot average values for each site during July

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tt <-}\StringTok{ }\NormalTok{logger_data }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(location, day, data_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{value =} \KeywordTok{mean}\NormalTok{(value)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(day }\OperatorTok{>=}\StringTok{ '2020-07-01'} \OperatorTok{&}
\StringTok{         }\NormalTok{day }\OperatorTok{<}\StringTok{ '2020-08-01'}
\NormalTok{         ) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{collect}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{Lokalitet =} \KeywordTok{factor}\NormalTok{(location, }\DataTypeTok{levels =} \KeywordTok{c}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Semi-nat_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{), }\KeywordTok{paste0}\NormalTok{(}\StringTok{"Skog_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{)))) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{data_type =} \KeywordTok{factor}\NormalTok{(data_type, }\DataTypeTok{levels =}\NormalTok{ )) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Missing values are always removed in SQL.
## Use `mean(x, na.rm = TRUE)` to silence this warning
## This warning is displayed only once per session.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{##Why can't I set the levels in the pipe?}
\KeywordTok{levels}\NormalTok{(tt}\OperatorTok{$}\NormalTok{data_type) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Duggpunkt"}\NormalTok{, }\StringTok{"Luftfuktighet"}\NormalTok{, }\StringTok{"Temperatur"}\NormalTok{, }\StringTok{"Lys"}\NormalTok{)}

\NormalTok{tt }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ day, }\DataTypeTok{y =}\NormalTok{ value, }\DataTypeTok{color =}\NormalTok{ Lokalitet)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{facet_wrap}\NormalTok{(}\OperatorTok{~}\NormalTok{data_type,}
             \DataTypeTok{scales =} \StringTok{"free"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Lokalitet"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Dag"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{""}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{legend.text=}\KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\KeywordTok{rel}\NormalTok{(}\FloatTok{0.5}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/avg_logger_july-1.png}

There seems to be two clusters of relative humidity values. They seem to
be different in the two location groups (Oslo, Lillehammer). Where they
placed differently? Or is it just altitude? Must plot this with altitude
as well.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{location_groups <-}\StringTok{ }\KeywordTok{tibble}\NormalTok{(}\DataTypeTok{location =} \KeywordTok{c}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Semi-nat_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{), }\KeywordTok{paste0}\NormalTok{(}\StringTok{"Skog_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{)),}
                          \DataTypeTok{location_group =} \KeywordTok{c}\NormalTok{(}\StringTok{"Oslo"}\NormalTok{, }\StringTok{"Lillehammer"}\NormalTok{, }\StringTok{"Lillehammer"}\NormalTok{, }\StringTok{"Lillehammer"}\NormalTok{,}
                                             \StringTok{"Oslo"}\NormalTok{, }\StringTok{"Lillehammer"}\NormalTok{, }\StringTok{"Lillehammer"}\NormalTok{, }\StringTok{"Lillehammer"}\NormalTok{,}
                                             \StringTok{"Oslo"}\NormalTok{, }\StringTok{"Oslo"}\NormalTok{, }\StringTok{"Oslo"}\NormalTok{, }\StringTok{"Oslo"}\NormalTok{, }\StringTok{"Oslo"}\NormalTok{, }\StringTok{"Lillehammer"}\NormalTok{,}
                                             \StringTok{"Lillehammer"}\NormalTok{, }\StringTok{"Lillehammer"}\NormalTok{, }\StringTok{"Oslo"}\NormalTok{, }\StringTok{"Lillehammer"}\NormalTok{,}
                                             \StringTok{"Oslo"}\NormalTok{, }\StringTok{"Lillehammer"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logger_data }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{filter}\NormalTok{(day }\OperatorTok{>=}\StringTok{ '2020-10-01'} \OperatorTok{&}
\StringTok{         }\NormalTok{day }\OperatorTok{<}\StringTok{ '2020-11-01'}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(location, data_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{value =} \KeywordTok{mean}\NormalTok{(value)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(data_type }\OperatorTok{==}\StringTok{ "dew"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{collect}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{location =} \KeywordTok{factor}\NormalTok{(location, }\DataTypeTok{levels =} \KeywordTok{c}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Semi-nat_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{), }\KeywordTok{paste0}\NormalTok{(}\StringTok{"Skog_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{)))) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{left_join}\NormalTok{(location_groups,}
            \DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"location"}\NormalTok{ =}\StringTok{ "location"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ location, }\DataTypeTok{y =}\NormalTok{ value, }\DataTypeTok{fill =}\NormalTok{ location_group), }\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Lokalitets-gruppe"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Lokalitet"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Middels duggpunkt i Juli"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{90}\NormalTok{, }\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{)) }
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/dew_point_group-1.png}

What happens if we only take the day time values?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logger_data }\OperatorTok{%>%}\StringTok{ }
\StringTok{      }\KeywordTok{filter}\NormalTok{(day }\OperatorTok{>=}\StringTok{ '2020-07-01'} \OperatorTok{&}
\StringTok{         }\NormalTok{day }\OperatorTok{<}\StringTok{ '2020-08-01'}\NormalTok{) }\OperatorTok{%>%}
\StringTok{      }\KeywordTok{collect}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{time =} \KeywordTok{as_hms}\NormalTok{(date)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(time }\OperatorTok{>=}\StringTok{ }\KeywordTok{as_hms}\NormalTok{(}\StringTok{"12:00:00"}\NormalTok{) }\OperatorTok{&}
\StringTok{           }\NormalTok{time }\OperatorTok{<}\StringTok{ }\KeywordTok{as_hms}\NormalTok{(}\StringTok{"18:00:00"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(data_type }\OperatorTok{==}\StringTok{ "dew"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(location) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{value =} \KeywordTok{mean}\NormalTok{(value)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{location =} \KeywordTok{factor}\NormalTok{(location, }\DataTypeTok{levels =} \KeywordTok{c}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Semi-nat_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{), }\KeywordTok{paste0}\NormalTok{(}\StringTok{"Skog_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{)))) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{left_join}\NormalTok{(location_groups,}
            \DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"location"}\NormalTok{ =}\StringTok{ "location"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ location, }\DataTypeTok{y =}\NormalTok{ value, }\DataTypeTok{fill =}\NormalTok{ location_group), }\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Location group"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Location"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Average dew point in July"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{90}\NormalTok{, }\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{)) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` ungrouping output (override with `.groups` argument)
\end{verbatim}

\includegraphics{figure/dew_point_group_day-1.png}

\hypertarget{check-correspondance-with-altitude}{%
\subsection{Check correspondance with
altitude}\label{check-correspondance-with-altitude}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{location_alt_q <-}\StringTok{ "}
\StringTok{SELECT location, avg(ST_Z(geom)) avg_altitude}
\StringTok{FROM traps.trap_locations}
\StringTok{WHERE elev_data IS TRUE}
\StringTok{GROUP BY location}
\StringTok{"}
\NormalTok{location_alt <-}\StringTok{ }\KeywordTok{dbGetQuery}\NormalTok{(con, location_alt_q)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logger_data }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{filter}\NormalTok{(day }\OperatorTok{>=}\StringTok{ '2020-10-01'} \OperatorTok{&}
\StringTok{         }\NormalTok{day }\OperatorTok{<}\StringTok{ '2020-11-01'}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(location, data_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{value =} \KeywordTok{mean}\NormalTok{(value)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(data_type }\OperatorTok{==}\StringTok{ "dew"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{collect}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{location =} \KeywordTok{factor}\NormalTok{(location, }\DataTypeTok{levels =} \KeywordTok{c}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Semi-nat_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{), }\KeywordTok{paste0}\NormalTok{(}\StringTok{"Skog_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{)))) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{left_join}\NormalTok{(location_groups,}
            \DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"location"}\NormalTok{ =}\StringTok{ "location"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{left_join}\NormalTok{(location_alt,}
            \DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"location"}\NormalTok{ =}\StringTok{ "location"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(avg_altitude)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ avg_altitude, }\DataTypeTok{y =}\NormalTok{ value, }\DataTypeTok{fill =}\NormalTok{ location_group), }\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Lokalitets-gruppe"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Lokalitets-altitud"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Middels duggpunkt i Juli"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{90}\NormalTok{, }\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{)) }
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/dew_point_alt-1.png}

The dew points seem to correspond quite well with the altitude,

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logger_data }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{filter}\NormalTok{(day }\OperatorTok{>=}\StringTok{ '2020-10-01'} \OperatorTok{&}
\StringTok{         }\NormalTok{day }\OperatorTok{<}\StringTok{ '2020-11-01'}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(location, data_type) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{value =} \KeywordTok{mean}\NormalTok{(value)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(data_type }\OperatorTok{==}\StringTok{ "rh"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{collect}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{location =} \KeywordTok{factor}\NormalTok{(location, }\DataTypeTok{levels =} \KeywordTok{c}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"Semi-nat_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{), }\KeywordTok{paste0}\NormalTok{(}\StringTok{"Skog_"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{)))) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{left_join}\NormalTok{(location_groups,}
            \DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"location"}\NormalTok{ =}\StringTok{ "location"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{left_join}\NormalTok{(location_alt,}
            \DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\StringTok{"location"}\NormalTok{ =}\StringTok{ "location"}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{(}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(avg_altitude)) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(.) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ avg_altitude, }\DataTypeTok{y =}\NormalTok{ value, }\DataTypeTok{fill =}\NormalTok{ location_group), }\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_nina}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Lokalitets-gruppe"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Lokalitets-altitud"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Middels duggpunkt i Juli"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{angle =} \DecValTok{90}\NormalTok{, }\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\DataTypeTok{hjust=}\DecValTok{1}\NormalTok{)) }
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/rh_point_alt-1.png}


\end{document}
